<!-- Plugin Configuration File. Read more: https://plugins.jetbrains.com/docs/intellij/plugin-configuration-file.html -->
<idea-plugin require-restart="true" xmlns:xi="http://www.w3.org/2001/XInclude">

    <change-notes/>
    <id>org.digma.intellij</id>
    <version>${project.version}</version>
    <name>Digma Continuous Feedback</name>
    <vendor>digma.ai</vendor>
    <description>
        Please write plugin description in README.md , see <!-- Plugin description --> section
    </description>
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.modules.vcs</depends>


    <xi:include href="/META-INF/org.digma.intellij-with-intellij-platform.xml" xpointer="xpointer(/idea-plugin/*)"/>

    <depends optional="true" config-file="org.digma.intellij-with-python.xml">com.intellij.modules.python</depends>
    <depends optional="true" config-file="org.digma.intellij-with-java.xml">com.intellij.modules.java</depends>
    <depends optional="true" config-file="org.digma.intellij-with-rider.xml">com.intellij.modules.rider</depends>


    <extensions defaultExtensionNs="com.intellij">
        <toolWindow id="Digma"
                    secondary="false"
                    icon="org.digma.intellij.plugin.icons.AppIcons.TOOL_WINDOW"
                    anchor="right"
                    factoryClass="org.digma.intellij.plugin.toolwindow.sidepane.DigmaSidePaneToolWindowFactory"/>

        <toolWindow id="Observability"
                    secondary="false"
                    icon="org.digma.intellij.plugin.icons.AppIcons.TOOL_WINDOW"
                    anchor="bottom"
                    factoryClass="org.digma.intellij.plugin.toolwindow.recentactivity.DigmaBottomToolWindowFactory"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.toolwindow.recentactivity.CustomViewerWindowService"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.ui.ToolWindowShower"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.service.EditorInteractionService"
                        serviceInterface="org.digma.intellij.plugin.ui.CaretContextService"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.analytics.AnalyticsService"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.document.DocumentInfoService"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.document.CodeLensProvider"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.ui.service.InsightsViewService"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.refreshInsightsTask.RefreshService"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.ui.service.ErrorsViewService"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.ui.service.SummaryViewService"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.insights.InsightsProvider"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.errors.ErrorsProvider"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.summary.SummariesProvider"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.service.InsightsActionsService"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.service.ErrorsActionsService"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.ui.service.TabsHelper"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.service.EditorService"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.vcs.VcsService"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.common.DumbAwareNotifier"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.analytics.BackendConnectionMonitor"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.analytics.BackendConnectionUtil"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.psi.LanguageServiceLocator"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.common.IDEUtilsService"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.posthog.ActivityMonitor"/>

        <notificationGroup id="Digma Notification Group"
                           displayType="NONE"
                           toolWindowId="Digma"/>


        <projectConfigurable
                parentId="tools"
                instance="org.digma.intellij.plugin.settings.ProjectSettings"
                id="org.digma.intellij.plugin.settings.ProjectSettings"
                displayName="Digma Plugin"
                nonDefaultProject="true"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.settings.SettingsState"/>

        <projectService serviceImplementation="org.digma.intellij.plugin.persistence.PersistenceService"/>

        <editorNotificationProvider implementation="org.digma.intellij.plugin.notifications.DigmaEditorNotificationProvider"
                                    id="org.digma.intellij.plugin.notifications.DigmaEditorNotificationProvider"/>

        <postStartupActivity implementation="org.digma.intellij.plugin.common.DumbAwareStartupActivity"/>


        <!-- Code lens providers are used only for some languages, for example java,python.
            They will not be used in Rider or C#, Rider does code lens in resharper.
         -->
        <projectService serviceImplementation="org.digma.intellij.plugin.codelens.CodeLensProviderFactory"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.ErrorHotspotCodeLensProvider"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.HighUsageCodeLensProvider"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.LowUsageCodeLensProvider"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.ScaleFactorCodeLensProvider"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.SlowEndpointCodeLensProvider"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.CodeLensMethodInsightsProvider1"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.CodeLensMethodInsightsProvider2"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.CodeLensMethodInsightsProvider3"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.CodeLensMethodInsightsProvider4"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.CodeLensMethodInsightsProvider5"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.CodeLensMethodInsightsProvider6"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.CodeLensMethodInsightsProvider7"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.CodeLensMethodInsightsProvider8"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.CodeLensMethodInsightsProvider9"/>
        <codeInsight.daemonBoundCodeVisionProvider implementation="org.digma.intellij.plugin.codelens.providers.CodeLensMethodInsightsProvider10"/>


    </extensions>


    <projectListeners>
        <listener
                class="org.digma.intellij.plugin.emvironment.EnvironmentChangeHandler"
                topic="org.digma.intellij.plugin.analytics.EnvironmentChanged"/>
        <listener
                class="org.digma.intellij.plugin.tab.TabChangeHandler"
                topic="org.digma.intellij.plugin.analytics.TabsChanged"/>
        <listener
                class="org.digma.intellij.plugin.debugger.DebuggerListener"
                topic="com.intellij.xdebugger.XDebuggerManagerListener"/>
        <listener
                class="org.digma.intellij.plugin.editor.GeneralFileEditorListener"
                topic="com.intellij.openapi.fileEditor.FileEditorManagerListener"/>
        <listener
                class="org.digma.intellij.plugin.common.modelChangeListener.ModelChangeHandler"
                topic="org.digma.intellij.plugin.common.modelChangeListener.ModelChangeListener"/>
        <listener
                class="org.digma.intellij.plugin.toolwindow.sidepane.DigmaSidePaneToolWindowListener"
                topic="com.intellij.openapi.wm.ex.ToolWindowManagerListener"/>
    </projectListeners>



</idea-plugin>
